function Auth(){var e=this;e.mask=document.getElementsByClassName("mask")[0],e.wrapper=e.mask.getElementsByClassName("inner-wrapper")[0],e.head=document.getElementById("header"),e.register_form=e.mask.getElementsByClassName("register-form")[0]}function getCookie(e){for(var t=e+"=",s=decodeURIComponent(document.cookie).split(";"),n=0;n<s.length;n++){for(var a=s[n];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""}Auth.prototype.run=function(){var e=this;e.showHideEvent(),e.loginEvent(),e.loginRegChange(),e.showHideBackend(),e.changeCaptcha(),e.GetCodeEvent(),e.RegisterEvent()},Auth.prototype.showHideEvent=function(){var e=this;e.login_btn=e.head.getElementsByClassName("login-btn")[0],e.register_btn=e.head.getElementsByClassName("register-btn")[0],e.close_btn=e.mask.getElementsByClassName("close-btn")[0],e.login_btn&&e.login_btn.addEventListener("click",function(){e.showEvent(),e.wrapper.style.left="0"}),e.register_btn&&e.register_btn.addEventListener("click",function(){e.showEvent(),e.wrapper.style.left="-400px"}),e.close_btn.addEventListener("click",function(){e.hideEvent()})},Auth.prototype.showEvent=function(){this.mask.style.display="block"},Auth.prototype.hideEvent=function(){this.mask.style.display="none"},Auth.prototype.loginEvent=function(){var e=this.mask.getElementsByClassName("login-form")[0],t=e.getElementsByClassName("login-btn")[0],s=e.getElementsByClassName("phone-input")[0],n=e.getElementsByClassName("password-input")[0];t.addEventListener("click",function(){var e="telephone="+s.value+"&password="+n.value,t=new XMLHttpRequest;t.open("post","http://127.0.0.1:8000/user/login/",!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.setRequestHeader("X-CSRFToken",getCookie("csrftoken")),t.send(e),t.addEventListener("readystatechange",function(){4===t.readyState&&(200===t.status?(console.log("success"),console.log(t.response),window.location.reload()):(console.log("failed"),console.log(t.response)))})})},Auth.prototype.loginRegChange=function(){var e=this,t=e.mask.getElementsByClassName("inner-wrapper")[0],s=e.mask.getElementsByClassName("login-form")[0].getElementsByClassName("change")[0],n=e.mask.getElementsByClassName("register-form")[0].getElementsByClassName("change")[0];s.addEventListener("click",function(){t.style.left="-400px"}),n.addEventListener("click",function(){t.style.left="0"})},Auth.prototype.showHideBackend=function(){var e=this.head.getElementsByClassName("right")[0],t=e.getElementsByClassName("auth-wrapper")[0];t&&(e.addEventListener("mouseover",function(){t.style.display="block"}),e.addEventListener("mouseout",function(){t.style.display="none"}))},Auth.prototype.changeCaptcha=function(){var e=this.mask.getElementsByClassName("captcha")[0],t=e.name;e.addEventListener("click",function(){var e="?random="+Math.random().toString().substr(-5);this.src=t+e})},Auth.prototype.GetCodeEvent=function(){var e=this.mask.getElementsByClassName("phone-btn")[0],t=this.register_form.getElementsByClassName("telephone")[0];e.addEventListener("click",function(){var e={method:"post",url:"http://127.0.0.1:8000/user/code/",params:{telephone:t.value}};Tool.ajaxRequest(e,function(e){console.log(e.response)})})},Auth.prototype.RegisterEvent=function(){var e=this,l=e.register_form.getElementsByClassName("username")[0],i=e.register_form.getElementsByClassName("telephone")[0],m=e.register_form.getElementsByClassName("password1")[0],g=e.register_form.getElementsByClassName("password2")[0],c=e.register_form.getElementsByClassName("auth-number")[0],u=e.register_form.getElementsByClassName("phone-number")[0],d=e.register_form.getElementsByClassName("register")[0];d.addEventListener("click",function(){var e=l.value,t=i.value,s=m.value,n=g.value,a=c.value,o=u.value,r={method:"post",url:d.name,params:{username:e,telephone:t,password1:s,password2:n,img_code:a,sms_code:o}};Tool.ajaxRequest(r,function(e){console.log(e.response)})})},window.auth=new Auth,window.auth.run();